C51 COMPILER V7.06   ADC                                                                   07/25/2013 23:19:41 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE ADC
OBJECT MODULE PLACED IN adc.OBJ
COMPILER INVOKED BY: C:\software\keil\C51\BIN\C51.EXE adc.c COMPACT BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          
   2          #include <intrins.h>  
   3          #include "config.h"
   4          #include "delay.h"
   5          
   6          /***********************************************************************
   7          Function : ADC_Init 
   8          Note     : ADC初始化
   9          ***********************************************************************/
  10          void ADC_Init(unsigned char Channel){  
  11   1              P1ASF = 0x01<<Channel;  //选择ADC的8个接口中的一个（对应位为1选中）  
  12   1              ADC_CONTR = 0x40;       //ADC转换的速度140个时钟周期（0XX0 0000 其中XX控制速度）  
  13   1              _nop_();  
  14   1              ADC_CONTR |= Channel;       //选择A/D当前通道  
  15   1              _nop_();  
  16   1              ADC_CONTR |= 0x80;      //启动A/D电源  
  17   1              DelayMs(1);             //使输入电压达到稳定（1ms即可）  
  18   1          }  
  19                
  20          /***********************************************************************
  21          Function : ADC_Read
  22          Note     : 读ADC值
  23          ***********************************************************************/
  24          unsigned int ADC_Read (void){  
  25   1              ADC_CONTR |= 0x08;      //启动A/D转换（0000 1000 令ADCS = 1）  
  26   1              _nop_();  
  27   1              _nop_();  
  28   1              _nop_();  
  29   1              _nop_();  
  30   1              while ( !(ADC_CONTR & 0x10) ); //等待A/D转换结束(ADC_FLAG==0)
  31   1              ADC_CONTR &= 0xE7;      //1111 0111 清ADC_FLAG位, 关闭A/D转换,   
  32   1         return (ADC_RES*4+ADC_RESL);//返回A/D转换结果（10位ADC数据高8位在ADC_RES中，低2位在ADC_RESL中）  
  33   1          }  
  34          
  35          
  36          
  37          
  38          
  39           


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     62    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
